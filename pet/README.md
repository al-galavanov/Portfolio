## Учебный проект 
### АСУ ТП "Водоподготовка" на базе ПЛК ОВЕН ПЛК200 (CoDeSys V3.5)

### **Цель**
Автоматизировать процесс заполнения, нагрева и поддержания уровня/температуры в резервуаре с визуализацией и дистанционным управлением

### **Аппаратное обеспечение (эмуляция)**
*   **ПЛК:** ОВЕН ПЛК200 + модули ввода/вывода:
    *   Аналоговый вход (AI): ОВЕН МВ110-224 (2AI 4-20мА) → *Датчики уровня, температуры*.
    *   Аналоговый выход (AO): ОВЕН МВ110-424 (2AO 4-20мА) → *Управление ТЭНом, клапаном*.
    *   Дискретный вход (DI): ОВЕН МВ110-104 (4DI) → *Кнопки "Старт", "Стоп", аварии*.
    *   Дискретный выход (DO): ОВЕН МВ110-202 (2DO реле) → *Сигнальные лампы, насос*.
*   **"Полевое" оборудование (эмуляция):**
    *   Датчик уровня (0-100%) → *Потенциометр / Генератор сигнала 4-20мА*.
    *   Датчик температуры (0-100°C) → *Термопара + преобразователь / Генератор сигнала*.
    *   Насос заполнения → *Лампа/Светодиод (сигнал DO)*.
    *   Электроклапан слива → *Лампа/Светодиод (сигнал DO)*.
    *   ТЭН нагрева → *Лампа/Светодиод (сигнал AO через SSR)*.
    *   Кнопки, переключатели.
*   **Сеть** \
Ethernet-коммутатор, ПК с CODESYS.

### **Программное обеспечение**
*   **Среда разработки:** CODESYS V3.5 SP 7.
*   **Целевая платформа:** [ОВЕН ПЛК200](https://owen.ru/product/plk200).
*   **Дополнительные инструменты:**  
    *   CODESYS WebVisu (для HMI) / Ignition Maker Edition (как альтернатива).
    *   OPC UA Server (встроенный в CODESYS).

### **3. Функциональные требования проекта**
1.  **Ручное управление:** Включение/выключение насоса, клапана, ТЭНа с HMI.
2.  **Автоматический режим:**
    *   **Заполнение резервуара:** Автоматический старт насоса при уровне < 20%, останов при уровне > 90%.
    *   **Поддержание температуры:** ПИД-регулятор для управления ТЭНом (уставка с HMI).
    *   **Аварийная остановка:** При уровне > 95% или температуре > 90°C.
3.  **Сигнализация:**  
    *   Визуальная/звуковая сигнализация аварий (HMI + лампы).
    *   Архивация аварий в ПЛК.
4.  **Визуализация (HMI):**  
    *   Мнемосхема резервуара с анимацией уровня, температуры.
    *   Тренды температуры/уровня.
    *   Панель управления (режимы, уставки, ручное управление).
5.  **Дистанционный мониторинг (опционально):**  
    *   Данные по OPC UA → Python-скрипт → Telegram-бот / Grafana.

---

### **4. Структура проекта в CODESYS**
```markdown
[Device] ОВЕН ПЛК200 (Ethernet)
├── [Programs]
│   ├── MAIN (PRG) - Организация вызова программ
│   ├── IO_Processing (PRG) - Чтение AI/DI, запись AO/DO
│   ├── AutoMode (PRG) - Логика автомата состояний (SFC)
│   ├── PID_Control (PRG) - ПИД-регулятор температуры (ST)
│   ├── Alarms (PRG) - Обработка аварий (FBD)
│   └── ManualMode (PRG) - Ручное управление
├── [Function Blocks]
│   ├── FB_ValveControl (FBD) - Управление клапаном
│   ├── FB_PumpControl (LD) - Управление насосом
│   └── FB_PID (ST) - Кастомный ПИД-блок
├── [Visualization]
│   ├── WebVisu_Reservoir (HMI) - Мнемосхема, тренды
│   └── AlarmViewer (HMI) - Таблица аварий
├── [OPC UA]
│   └── Server_Config - Настройка OPC UA сервера
└── [GVL] (Global Variable Lists)
    ├── Constants (Константы)
    ├── Inputs (DI, AI)
    ├── Outputs (DO, AO)
    └── ProcessVars (Уровень, Температура, Уставки)
```

### **5. Пошаговый план реализации**
**Этап 1: Настройка аппаратной части и ПО**  
1.  Собрать схему стенда (реальные устройства или эмуляция сигналов).  
2.  Установить CODESYS V3.5 + Device Repository для ОВЕН ПЛК110.  
3.  Настроить связь ПК ↔ ПЛК (Ethernet, загрузить бут-приложение).  

**Этап 2: Разработка ПО ПЛК**  
4.  Создать проект в CODESYS, добавить устройство ПЛК110.  
5.  Настроить I/O Mapping (привязать AI/AO/DI/DO к переменным).  
6.  Реализовать:  
    *   Обработку дискретных сигналов (`IO_Processing`).  
    *   Ручное управление (`ManualMode`).  
    *   Логику автомата состояний (`AutoMode` на SFC/LD).  
    *   ПИД-регулятор (`FB_PID` на ST, настройка коэффициентов).  
    *   Аварийную сигнализацию (`Alarms`).  

**Этап 3: Визуализация (WebVisu)**  
7.  Создать мнемосхему резервуара с анимированным уровнем/температурой.  
8.  Добавить элементы управления (кнопки, поля ввода уставок).  
9.  Настроить тренды для архивации данных.  
10. Создать экран просмотра аварий.  

**Этап 4: Интеграция и дополнительные функции**  
11. Настроить OPC UA Server в CODESYS.  
12. (Опционально) Написать Python-скрипт: чтение данных OPC UA → отправка в Telegram.  
13. Реализовать простое резервирование (например, переключение на ручной режим при аварии).  

**Этап 5: Тестирование и отладка**  
14. Проверить все режимы работы (ручной/авто).  
15. Протестировать реакцию на аварии.  
16. Отладить ПИД-регулятор (симуляция скачков температуры).  

---

### **6. Что выложить на GitHub (Безопасно!)**
```
/Project_ASUTP_WaterTreatment
├── /Docs
│   ├── Project_Description.md (Цели, функционал, скриншоты)
│   ├── Hardware_Scheme.drawio (Схема подключения в Draw.io)
│   └── IO_List.xlsx (Список сигналов)
├── /Src
│   ├── /PLC (Экспорт проекта CODESYS *.project)
│   ├── /HMI (Файлы WebVisu)
│   └── /Scripts (Python для OPC/Telegram)
├── /Images
│   ├── wiring_photo.jpg (Фото стенда)
│   ├── hmi_screenshot.png (Скрин мнемосхемы)
│   └── trend_example.png (График ПИД)
└── README.md (Детальное описание проекта)
```

**Важно в README.md:**  
```markdown
# АСУ Учебного стенда "Водоподготовка" (ПЛК ОВЕН ПЛК110 + CODESYS V3.5)

## Цель проекта
Автоматизация виртуального процесса водоподготовки с ПИД-регулированием, аварийной сигнализацией и визуализацией.

## Ключевые технологии
- **ПЛК:** ОВЕН ПЛК110
- **Среда:** CODESYS V3.5.17.0
- **Языки:** ST, FBD, SFC, LD
- **HMI:** CODESYS WebVisu
- **Протоколы:** OPC UA, Modbus TCP (опционально)

## Функции
- Автоматическое заполнение резервуара
- ПИД-регулирование температуры
- 3 режима работы: Ручной, Авто, Авария
- Визуализация в Web-браузере
- OPC UA сервер для интеграции

## Скриншоты
![Мнемосхема](Images/hmi_screenshot.png)
![Тренды](Images/trend_example.png)

## Как запустить
1. Импортируйте проект `PLC/WaterTreatment.project` в CODESYS V3.5.
2. Загрузите программу в ПЛК ОВЕН ПЛК110.
3. Откройте `WebVisu/index.html` в браузере.
```

---

### **7. Ключевые навыки, которые продемонстрирует проект**
1.  Работа с **российским ПЛК** (ОВЕН) и **CODESYS V3.5**.  
2.  Программирование на **всех языках МЭК 61131-3** (ST для ПИД, FBD для логики, SFC для автомата).  
3.  Настройка **аппаратных модулей** (AI/AO/DI/DO).  
4.  Разработка **HMI** (WebVisu) с трендами и алармами.  
5.  Интеграция по **OPC UA**.  
6.  Реализация **ПИД-регулятора**.  
7.  Документирование и **структурный код**.  

---

### **Советы для успеха**
1.  **Эмуляция вместо реальных котлов:** Используйте потенциометры/лампы для имитации процесса — безопасно и дёшево.  
2.  **Видео-демо:** Запишите 2-минутный ролик работы системы → добавьте в README.  
3.  **Акцент на российские решения:** Упоминайте ОВЕН/CODESYS в описании навыков на GitHub и LinkedIn.  
4.  **Разберите ошибки:** В документации опишите 1-2 проблемы при настройке и как их решили — это ценится.  

Такой проект займёт 1-2 недели, но станет **мощным кейсом** в портфолио, особенно для работы с российским оборудованием.
